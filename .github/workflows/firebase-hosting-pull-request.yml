# This file was auto-generated by the Firebase CLI
# https://github.com/firebase/firebase-tools

name: Deploy to Firebase Hosting on PR
'on':
  pull_request:
    branches:
      - develop
# develop 브랜치에 pull request 이벤트가 발생하면 workflow trigger
# TODO checkList : 다수의 브랜치를 설정할 수 있는지 테스트 필요

# 하나의 워크플로는 여러개의 job으로 구성된다.
jobs:
  build_and_preview: # Job명칭을 작성한다.
    if: '${{ github.event.pull_request.head.repo.full_name == github.repository }}'
    runs-on: ubuntu-latest
    # 하나의 job은 여러개의 step으로 구성된다.
    steps:
      # uses는 기존에 만들어진 action을 사용하는 것
      - uses: actions/checkout@v3
      # npm ci(clean install)을 통해 package.json에 명시된 모든 의존성을 설치
      # 해당 명령을 수행하지 않을 경우 vue실행에 필요한 의존성이 설치되지 않아 vue-cli-service 명령어를 실행할 수 없음.
      - run: 'npm ci'
      - run: 'pwd && cd ./src/common && ls && cd ../ && cd ../'
      - run: 'npm run build'
      - uses: FirebaseExtended/action-hosting-deploy@v0
        with:
          repoToken: '${{ secrets.GITHUB_TOKEN }}'
          firebaseServiceAccount: '${{ secrets.FIREBASE_SERVICE_ACCOUNT_BASKETBALLDIARY_FRONTEND }}'
          projectId: basketballdiary-frontend
